## Average files

# Merge replicates using bigWigMerge
bigWigMerge input1.bw input2.bw input3.bw output.bedgraph

#Divide the scores by the number of samples merged
awk  -F "\t" '{print $1, $2, $3, $4/3}' output.bedgraph > average.bedgraph
  #3 is number of samples merged. This needs to bechanged accordingly
  
#Sort the filtered output
sort -k1,1 -k2,2n average.bedgraph > average.sorted.bedgraph

#if needed Run bedGraphToBigWig to convert bedgraph to bigwig for visualization
bedGraphToBigWig average.sorted.bedgraph chromosome.len average.sorted.bw
  # chromosome.len contains the chromsomosome # and its length, e.g. chr1 1234567
  
#10,000 bp windows data generation
multiBigwigsummary bins -b sample1.average.sorted.bw sample2.average.sorted.bw sample3.average.sorted.bw -o 10kbsummary.npz -bs 10000 -p 32 --outRawCounts 10kbsummary_counts.txt

#Used "10kbsummary_counts.txt" to generate scatter plots using GraphPad Prism7
